name: Weekday Activity

on:
  schedule:
    # Runs Mondayâ€“Friday at 10:30 AM IST (05:00 UTC)
    - cron: '0 5 * * 1-5'
  workflow_dispatch:

jobs:
  weekday-activity:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Random weekday logic
        run: |
          git config --global user.name "prem7475"
          git config --global user.email "premnarayani1682@gmail.com"

          # Random skip (~30% chance)
          SKIP=$((RANDOM % 10))

          # 0,1,2 = skip (~30%)
          if [ "$SKIP" -lt 3 ]; then
            echo "Skipping today..."
            exit 0
          fi

          FILE="dev-notes.md"
          touch $FILE

          TODAY=$(date +'%Y-%m-%d')

          # Prevent duplicate same-day commit
          if grep -q "$TODAY" $FILE; then
            echo "Already updated today."
            exit 0
          fi

          echo "- Work log entry for $TODAY" >> $FILE

          git add $FILE
          git commit -m "docs: update daily log for $TODAY"
          git push origin main
